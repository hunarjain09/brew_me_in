#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ§ª Running e2e tests before push..."

# Ensure backend .env file exists for tests
if [ ! -f backend/.env ]; then
  echo "ğŸ“ Creating backend/.env from .env.example..."
  cp backend/.env.example backend/.env
fi

# Run e2e tests (Playwright will handle starting/stopping the dev server)
npm run test:e2e

if [ $? -ne 0 ]; then
  echo "âŒ E2E tests failed. Push aborted."
  echo "ğŸ’¡ Fix the failing tests or use --no-verify to skip this check."
  exit 1
fi

echo "âœ… E2E tests passed. Proceeding with push..."
